config:
  target: "https://httpbin.org"
  phases:
    - duration: 1
      arrivalRate: 1
  plugins:
    ensure: {}
  ensure:
    thresholds:
     - http.response_time.p95: 1000        #sprawdzamy czy p95 jest mniejsze niż podany przez nas czas 1000ms, u nas to jest 120.3ms czyli zwraca ok
    conditions: 
     - expression: vusers.failed == 0 # Sprawdzanie, czy liczba nieudanych użytkowników (vusers) wynosi 0
     - expression: "http.request.rate >=2" # Sprawdzanie, czy wskaźnik liczby żądań HTTP na sekundę jest większy lub równy 2
     - expression: "http.response_time.mac < 600" # Sprawdzanie, czy maksymalny czas odpowiedzi HTTP jest mniejszy niż 600 ms

scenarios:
  # Scenariusz 1: Pobierz post, dodaj nowy post, pobierz komentarze do nowego posta
  - name: Getting a resource
    flow:
      - get:
          url: "{{  target  }}get"
      - post:
          url: "{{  target  }}post"
          json:
            username: "Test_example_user"
            password: "Test_example_password"
          capture:
            - json: "$.json"
              as: "request_body"
            -json: "$.headers.Host"
              as: "host"
          - log: "Json value from response is: {{ request_body  }}"
          - log: "Host value from reposnse is: {{  host  }}"